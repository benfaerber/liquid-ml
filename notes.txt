Lex Liquid

Blocks:
Text
Statement {% %}
Expression {{ }}
Liquid
{% liquid

%}

Block List is a token grid
-----------------------------
Block Token Token Token Token
Block Token Token Token Token
Block Token Token Token Token
Block Token Token Token Token


What is a syntax tree?
Basic tree structure of nodes and leaves

type 'a tree =
| Leaf ()
| Node of 'a * 'a tree * 'a tree


Liquid block must compile the same as normal block

{% if x == y %}
  Hi there
{% endif %}

{%liquid
if x == y
  echo "Hi There"
endif
%}

{{ horse }}

Global (
  If ID(X) Eq ID(Y) Expression( Text(Hi There) ) Endif

  Expression(
    ID(horse)
  )
)

--------

{{ animal | capitalize | remove : "h" | slice: 0, 2 }}

The first param is the thing the filter is applied to
A filter has a name and a list of params
Operators are converted to function

Func (slice) (
  Func (remove) (
    Func (capitilize) (
      Value ( Var ("animal") )
    )
    Value ( String ("h") )
  )
  Value ( Number (0) )
  Value ( Number (2) )
)

if x == 1

Func (eq) (
  Value ( Var ("x") )
  Value ( Number (1))
)
